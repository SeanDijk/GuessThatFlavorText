import{S as y,i as P,s as R,l as D,a as G,m as N,n as O,c as $,h as m,b,F as q,f as c,t as u,d as A,w as B,x as E,y as F,B as I,r as J,u as M,g as Q,M as T}from"../../chunks/index-f8c949a3.js";import{b as U}from"../../chunks/index-30ebe04c.js";import{b as _}from"../../chunks/paths-b9644fda.js";import{C as V}from"../../chunks/CardGuess-61a64628.js";import{P as j}from"../../chunks/PokemonApiService-8b675361.js";import{r as z}from"../../chunks/stores-90196818.js";import"../../chunks/singletons-eca981c1.js";import"../../chunks/LoadingIcon-cafd759b.js";import"../../chunks/close-icon-2ac8c1d9.js";import"../../chunks/index-66cf2f4f.js";function g(o){let t,a,n={card:o[0]};return t=new V({props:n}),o[3](t),{c(){B(t.$$.fragment)},l(e){E(t.$$.fragment,e)},m(e,r){F(t,e,r),a=!0},p(e,r){const s={};r&1&&(s.card=e[0]),t.$set(s)},i(e){a||(c(t.$$.fragment,e),a=!0)},o(e){u(t.$$.fragment,e),a=!1},d(e){o[3](null),I(t,e)}}}function h(o){let t;return{c(){t=J("Something went wrong while retrieving the card.")},l(a){t=M(a,"Something went wrong while retrieving the card.")},m(a,n){b(a,t,n)},d(a){a&&m(t)}}}function H(o){let t,a,n,e=(o[2]===!1||o[0]!=null)&&g(o),r=o[2]===!0&&o[0]==null&&h();return{c(){t=D("div"),e&&e.c(),a=G(),r&&r.c()},l(s){t=N(s,"DIV",{});var i=O(t);e&&e.l(i),a=$(i),r&&r.l(i),i.forEach(m)},m(s,i){b(s,t,i),e&&e.m(t,null),q(t,a),r&&r.m(t,null),n=!0},p(s,[i]){s[2]===!1||s[0]!=null?e?(e.p(s,i),i&5&&c(e,1)):(e=g(s),e.c(),c(e,1),e.m(t,a)):e&&(Q(),u(e,1,1,()=>{e=null}),A()),s[2]===!0&&s[0]==null?r||(r=h(),r.c(),r.m(t,null)):r&&(r.d(1),r=null)},i(s){n||(c(e),n=!0)},o(s){u(e),n=!1},d(s){s&&m(t),e&&e.d(),r&&r.d()}}}function K(o,t,a){let{card:n}=t,e,r=!1,s=[];z.enabledSets.subscribe(l=>s=JSON.parse(l));async function i(){var d,p;let l=(p=(d=e==null?void 0:e.getDialog())==null?void 0:d.close())!=null?p:await Promise.resolve(),S=s.length===0?"":"("+s.map(f=>`set.id:${f}`).reduce((f,C)=>f+" OR "+C)+")",k=j.getRandomCard(S);await l,a(0,n=null),a(0,n=await k),a(2,r=!0)}n==null&&i(),U(l=>{l.from!=null&&l.to!=null&&l.from.pathname===l.to.pathname&&(l.to.pathname===`${_}/guess/random`||l.to.pathname===`/${_}/guess/random`)&&(l.cancel(),i())});function w(l){T[l?"unshift":"push"](()=>{e=l,a(1,e)})}return o.$$set=l=>{"card"in l&&a(0,n=l.card)},[n,e,r,w]}class ae extends y{constructor(t){super(),P(this,t,K,H,R,{card:0})}}export{ae as default};
